# Аналитика в авиакомпании


## Описание проекта
Вы аналитик российской авиакомпании F9, которая выполняет внутренние пассажирские перевозки. Для развития компании важно понять предпочтения пользователей, покупающих билеты на разные направления.
Вам предстоит изучить базу данных и проанализировать спрос пассажиров на рейсы в города, где проходят крупнейшие фестивали.


## Описание данных

База данных об авиаперевозках состоит из нескольких таблиц:
Таблица _airports_ — информация об аэропортах:
_airport_code_ — трёхбуквенный код аэропорта,
_airport_name_ — название аэропорта,
_city_ — город,
_timezone_ — часовой пояс.

Таблица _aircrafts_ — информация о самолётах:
_aircraft_code_ — код модели самолёта,
_model_ — модель самолёта,
_range_ — дальность полётов.

Таблица _tickets_ — информация о билетах:
_ticket_no_ — уникальный номер билета,
_passenger_id_ — уникальный идентификатор пассажира,
_passenger_name_ — имя и фамилия пассажира.

Таблица _flights_ — информация о рейсах:
_flight_id_ — уникальный идентификатор рейса,
_departure_airport_ — аэропорт вылета,
_departure_time_ — дата и время вылета,
_arrival_airport_ — аэропорт прилёта,
_arrival_time_ — дата и время прилёта,
_aircraft_code_ — уникальный идентификатор самолёта.

Таблица _ticket_flights_ — стыковая таблица «рейсы-билеты»:
_ticket_no_ — номер билета,
_flight_id_ — уникальный идентификатор рейса.

Таблица _festivals_ — информация о фестивалях:
_festival_id_ — уникальный номер фестиваля,
_festival_date_ — дата проведения фестиваля,
_festival_city_ — город проведения фестиваля,
_festival_name_ — название фестиваля.

## Схема таблиц

![db_f9](https://pictures.s3.yandex.net/resources/photo_2019-11-08_14-08-31_1573733426.jpg "рейсы авиакомпании F9")​


*Примечание* В базе данных нет прямой связи между таблицами _airports_ и _festivals_, а также _festivals_ и _flights_. Первые две таблицы вы можете связать оператором _JOIN_ по городу проведения фестиваля _festival_city_ и городу с аэропортом _city_. Связать _festivals_ и _flights_ в запросах с _JOIN_ можно по дате проведения фестиваля _festival_date_, предварительно преобразовав даты в таблице _flights_.


## Инструкция по выполнению проекта

Проект состоит из двух частей: тренажёр и Jupyter Notebook для отправки на проверку. Шаги 1, 2 и 3 выполните в тренажёре, а шаг 4 — в Jupyter Notebook.

### Шаг 1. Напишите парсер для сбора с сайта данных о 11 крупнейших фестивалях 2018 года

Ссылка на сайт: https://code.s3.yandex.net/learning-materials/data-analyst/festival_news/index.html

### Шаг 2. Исследовательский анализ данных

* Найдите количество рейсов с вылетом в сентябре 2018 года на каждой модели самолёта. Назовите получившееся поле _flights_amount_ и выведите его, также выведите поле _model_.
* Посчитайте количество рейсов по всем моделям самолетов Boeing и Airbus в сентябре. Назовите получившуюся переменную _flights_amount_ и выведите ее.
* Посчитайте среднее количество прибывающих рейсов в день для каждого города за август 2018 года. Назовите получившееся поле _average_flights_ , вместе с ней выведите столбец _city_.

### Шаг 3. Подготовьте данные о количестве рейсов во время фестивалей

* Установите фестивали, которые проходили с 23 июля по 30 сентября 2018 года в Москве, и номер недели, в которую они проходили. Выведите название фестиваля _festival_name_ и номер недели _festival_week_.
* Для каждой недели с 23 июля по 30 сентября 2018 года посчитайте количество билетов, купленных на рейсы в Москву (номер недели _week_number_ и количество рейсов _flights_amount_). Получите таблицу, в которой будет информация о количестве купленных за неделю билетов, отметка, проходил ли в эту неделю фестиваль, название фестиваля _festival_name_ и номер недели _week_number_.

### Шаг 4. Аналитика средствами Python

У вас есть файлы, в которых содержатся результаты запросов из предыдущих заданий.

*/datasets/query_1.csv*  — результат первого запроса. В нём содержится информация:

* _model_ — о модели самолета,
* _flights_amount_ — количество рейсов для каждой модели самолетов _model_ в сентябре 2018 года.

*/datasets/query_3.csv* — результат третьего запроса. В нём содержится информация:

* _city_ — о городах,
* _average_flights_ — о среднем количестве рейсов, прибывающих в город _city_ за день в августе 2018 года.
Для этих двух наборов данных нужно:
* импортировать файлы;
* изучить данные в них;
* проверить типы данных на корректность;
* выбрать топ-10 городов по количеству рейсов;
* построить графики: модели самолетов и количество рейсов, города и количество рейсов, топ-10 городов и количество рейсов;
* сделать выводы по каждому из графиков, пояснить результат.









